# 3.2.8 跨域和 HTTP

## 跨域
>跨域是指一个域下的文档或者脚本试图去请求另一个域下的资源.

## 什么是同源策略
>同源策略是浏览器最核心也最按基本的安全功能,缺少了同源策略,浏览器很容易受到xss、csfr等攻击.

- 同源: 网络协议 域名 端口 三者相同 . 
- 同源策略限制一下几种行为: 
  - 1. cookie localstorage 和 indexdb 无法读取
  - 2. dom 和 js对象无法获得
  - 3. ajax 请求不能发送


## 跨域解决方案
  - 1、 通过jsonp跨域
  - 2、 document.domain + iframe跨域
  - 3、 location.hash + iframe
  - 4、 window.name + iframe跨域
  - 5、 postMessage跨域
  - 6、 跨域资源共享（CORS）
  - 7、 nginx代理跨域
  - 8、 nodejs中间件代理跨域
  - 9、 WebSocket协议跨域

- 参考：
  - [前端常见跨域解决方案](https://blog.csdn.net/xjhdgjnd/article/details/78067295)


## http 协议
  Hyper Text Transfer Protocol（超文本传输协议）
  
  HTTP是一个应用层协议，由请求和响应构成，是一个标准的客户端服务器模型。HTTP是一个无状态的协议。
  
  

* http 状态值  ajax 的 readyState  
  - 0 － （未初始化）还没有调用send()方法 
  - 1 － （载入）已调用send()方法，正在发送请求 
  - 2 － （载入完成）send()方法执行完成，已经接收到全部响应内容 
  - 3 － （交互）正在解析响应内容 
  - 4 － （完成）响应内容解析完成，可以在客户端调用了
  
* http 状态码
  ```
  1xx：请求收到，继续处理
  2xx：操作成功收到，分析、接受
  3xx：完成此请求必须进一步处理
  4xx：请求包含一个错误语法或不能完成
  5xx：服务器执行一个完全有效请求失
  ```
  - 200, OK，访问正常
  - 301, Moved Permanently，永久移动
  - 302, Move temporarily，暂时移动
  - 304, Not Modified，未修改
  - 307, Temporary Redirect，暂时重定向
  - 401, Unauthorized，未授权
  - 403, Forbidden，禁止访问
  - 404, Not Found，未发现指定网址
  - 500, Internal Server Error，服务器发生错误


##  Https与Http

- 1、https 协议需要到 ca 申请证书，一般免费证书较少，因而需要一定费用。

- 2、http 是超文本传输协议，信息是明文传输，https 则是具有安全性的 ssl 加密传输协议。

- 3、http 和 https 使用的是完全不同的连接方式，用的端口也不一样，前者是 80，后者是 443。

- 4、http 的连接很简单，是无状态的；HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输、身份认证的网络协议，比 http 协议安全。


##  https工作原理

客户端在使用 HTTPS 方式与 Web 服务器通信时有以下几个步骤，如图所示。

- （1）客户使用 https 的 URL 访问 Web 服务器，要求与 Web 服务器建立 SSL 连接。

- （2）Web 服务器收到客户端请求后，会将网站的证书信息（证书中包含公钥）传送一份给客户端。

- （3）客户端的浏览器与 Web 服务器开始协商 SSL 连接的安全等级，也就是信息加密的等级。

- （4）客户端的浏览器根据双方同意的安全等级，建立会话密钥，然后利用网站的公钥将会话密钥加密，并传送给网站。

- （5）Web 服务器利用自己的私钥解密出会话密钥。

- （6）Web 服务器利用会话密钥加密与客户端之间的通信。

## https优缺点

- （1）HTTPS 协议握手阶段比较费时，会使页面的加载时间延长近 50%，增加 10% 到 20% 的耗电；

- （2）HTTPS 连接缓存不如 HTTP 高效，会增加数据开销和功耗，甚至已有的安全措施也会因此而受到影响；

- （3）SSL 证书需要钱，功能越强大的证书费用越高，个人网站、小网站没有必要一般不会用。

- （4）SSL 证书通常需要绑定 IP，不能在同一 IP 上绑定多个域名，IPv4 资源不可能支撑这个消耗。

- （5）HTTPS 协议的加密范围也比较有限，在黑客攻击、拒绝服务攻击、服务器劫持等方面几乎起不到什么作用。最关键的，SSL 证书的信用链体系并不安全，特别是在某些国家可以控制 CA 根证书的情况下，中间人攻击一样可行。



--------------------- 
作者：谁动了我的bug 
原文：https://blog.csdn.net/qq_35393693/article/details/80282102 


## 参考
- []()
- [2.大型网站的 HTTPS 实践（一）—— HTTPS 协议和原理 ](http://op.baidu.com/2015/04/https-s01a01/)
- [3.SSL工作原理 ](https://www.wosign.cn/Basic/howsslwork.htm)
- [4.SSL/TLS协议运行机制的概述 ](http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html)
- [5.HTTPS工作原理，猫尾博客](https://cattail.me/tech/2015/11/30/how-https-works.html)
- [6.HTTPS那些事（一）HTTPS原理，晓风残月](http://www.guokr.com/post/114121/)
- [7.HTTPS证书生成原理和部署细节，小胡子哥](http://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/)


