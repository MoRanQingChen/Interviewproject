# 3.3.4 双向数据绑定原理


## 1.实现数据绑定的做法有大致如下几种：

- 发布者-订阅者模式（backbone.js）
- 脏值检查（angular.js）
- 数据劫持（vue.js）

### 1.1发布者-订阅者模式
>使用自定义的data属性在HTML代码中指明绑定。所有绑定起来的JavaScript对象以及DOM元素都将“订阅”一个发布者对象。  
任何时候如果JavaScript对象或者一个HTML输入字段被侦测到发生了变化，我们将代理事件到发布者-订阅者模式，  
这会反过来将变化广播并传播到所有绑定的对象和元素。  

### 1.2 脏值检查
>angular.js 是通过脏值检测的方式比对数据是否有变更，来决定是否更新视图，

最简单的方式就是通过 setInterval() 定时轮询检测数据变动，angular只有在指定的事件触发时进入脏值检测，大致如下：

- DOM事件，譬如用户输入文本，点击按钮等。( ng-click )
- XHR响应事件 ( $http )
- 浏览器Location变更事件 ( $location )
- Timer事件( $timeout , $interval )
- 执行 $digest() 或 $apply()

### 1.3数据劫持
通过 Object.defineProperty() 来劫持各个属性的 setter，getter，  
在数据变动时发布消息给订阅者，触发相应的监听回调。


## 用原生js的 Object.defineProperty() 写一个双向数据绑定

- 用原生Javascript对象中的访问器属性实现双向数据绑定
```
var input = document.querySelector("#text");
var data = {};
Object.defineProperty(data, "name", {
  configurable: true,
  get: function(){
      return input.value
  },
  set: function(newValue){
    //this.value = newValue;
    input.value = newValue;
  }
})
data.name = "sss";
input.onchange = function(){
  data.name = data.name;
}

作者：darr250
链接：https://www.jianshu.com/p/e8df6e3f6e34
```




## 参考
- [DMQ/mvvm](https://github.com/DMQ/mvvm)
